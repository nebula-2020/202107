# 设计稿

## 问题分析

### 应该统计哪些量

* ~~飞机高度占总高度的比例~~
* ~~飞机宽度占总宽度的比例~~
* 飞机中点占总高度的比例
* 飞机下降速度占总高度的比例
* ~~飞机弹跳力占总高度的比例~~
* ~~飞机下降加速度占总高度的比例~~
* ~~飞机前向速度占总宽度的比例~~
* 门中点占总高度的比例
* ~~门高度占总高度的比例~~
* ~~门宽度占总宽度的比例~~
* 飞机左侧与门右侧水平距离占总宽度的比例

最后我们取：

* 飞机左侧与门右侧水平距离占当前两门间距的比例
* 飞机中点与门中点垂直距离占总高度的比例

速度和飞机弹跳后经过的帧数有关，不用统计。

### 问题特点

* 时间不连续，最小单位为“帧”
* 状态status是连续的浮点数值
* 动作action只有2种，即“跳”和“不跳”
* 动作的结果概率为1

总结下来状态空间连续而动作空间不连续。

## 数据结构设计

* 游戏：玩家尺寸，所有门的尺寸，玩家速度，玩家加速度，重力，弹跳力，玩家中心坐标，门中心坐标，游戏屏幕尺寸，两门间隔，游戏积分
* 环境：玩家尺寸，**离玩家最近的还未通过**的门的尺寸，玩家速度，玩家加速度，重力，弹跳力，玩家中心坐标，门中心坐标，**游戏屏幕高度**，两门间隔

数据结构应该采用不可变的数据类型，每次迭代都产生新对象。

## 算法设计

神经元模型+贝尔曼方程

神经元输入$\boldsymbol{s}$计算得到$\hat{a}$，然后计算$V(\boldsymbol{s})$进而得到$a^*$，然后用$a^*$当真实类别用于更新神经元权值。

问题是非线性分类，需要神经网络，输入层2个神经元，输出层2个神经元，可以再加一个3神经元的隐层，多出来的3-2=1个神经元可能用来判断飞机速度。

## 程序设计

框架采用pygame和tensorflow，都比较常用，文档全。

1. 随机初始化模型
2. 基于当前模型，计算数十种状态下每一种动作的价值，价值最大的动作作为正样本，批量梯度下降。
3. 重复上述操作第2步直至模型收敛。
